<!DOCTYPE HTML>
<html lang="en-US">
<head>
	<meta charset="UTF-8">
	<title>Test 5</title>
	<style type="text/css">
		html {overflow:hidden}
		body {position: absolute; margin:0; padding:0;width:100%; height:100%}
		canvas {display:block;border:2px solid #ccc; margin:10px auto;}
		p {text-align: center; font-size:12px;color:#454545;}
	</style>
	<script type="text/javascript" src="js/june.js"></script>
	<script type="text/javascript" src="js/plugin.js"></script>
</head>
<body>
	<canvas id="canvas" width="600" height="400"></canvas>
	
	<script type="text/javascript">
		var canvas = document.getElementById('canvas');
		var stage = new June.stage(canvas, 600, 400);
		
		
		function Rects(stage, rect){
			//前后
			this.stage = stage;
			this.data = null;
			this.after = [];
			//this.rects = [];
			this.rect = rect;
			//this.init();
		}

		Rects.prototype = {
			init:function(){},
			setRectData:function(data){
				this.data = data;
			},
			frontBackInit:function(){
				var after = this.after;
				var data = this.data;
				//var rects = this.rects;
				var frontRects = this.frontRects = [];
				var backRects = this.backRects = [];
				for(var i=0; i<data.length; i++){
					after.push([data[i][0], data[i][1], -data[i][2]]);
					frontRects.push(new this.rect(this.stage, data[i][0], data[i][1], data[i][2], "#f30f30", 0));
					backRects.push(new this.rect(this.stage, data[i][0], data[i][1], -data[i][2], "#cccccc", 2));
				}
				
			},
			upDownInit:function(){
				var after = this.after;
				var data = this.data;
				var upRects = this.upRects = [];
				var downRects = this.downRects = [];
				
				for(var i=0; i<data.length; i++){
					after.push([data[i][0], data[i][1], -data[i][2]]);
					upRects.push(new this.rect(this.stage, data[i][0], data[i][1], data[i][2], "#ff9900", 4));
					downRects.push(new this.rect(this.stage, data[i][0], -data[i][1], data[i][2], "#3c00ff", 5));
				}
			},
			leftRightInit:function(){
				var after = this.after;
				var data = this.data;
				var leftRects = this.leftRects = [];
				var rightRects = this.rightRects = [];
				for(var i=0; i<data.length; i++){
					after.push([data[i][0], data[i][1], -data[i][2]]);
					rightRects.push(new this.rect(this.stage, data[i][0], data[i][1], data[i][2], "#3ab504", 3));
					leftRects.push(new this.rect(this.stage, -data[i][0], data[i][1], data[i][2], "#fff60e", 1));
				}
			},
			setDepth:function(depth, rects){
				for(var i=0; i<rects.length; i++){
					rects[i].setDepth(depth);
				}
			}
		};
		
		//*
		//上下
		var updown = new Rects(stage, UpDownRect);
		updown.data = [
			[-155, -155, 155],
			[-50, -155, 155],
			[55, -155, 155],
			
			[-155, -155, 50],
			[-50, -155, 50],
			[55, -155, 50],
			
			[-155, -155, -55],
			[-50, -155, -55],
			[55, -155, -55],
			
		];
		updown.upDownInit();
		
		
		// 前后
		var frontBack = new Rects(stage, FrontBackRect);
		frontBack.data = [
			[-155, -155, -155],
			[-155, -50, -155],
			[-155, 55, -155],
			
			[-50, -155, -155],
			[-50, -50, -155],
			[-50, 55, -155],
			
			[55, -155, -155],
			[55, -50, -155],
			[55, 55, -155]
		];
		frontBack.frontBackInit();
		
		//*
		//左右
		var leftRight = new Rects(stage, LeftRightRect);
		leftRight.data = [
			[155, -155, -155],
			[155, -155, -50],
			[155, -155, 55],
			
			[155, -50, -155],
			[155, -50, -50],
			[155, -50, 55],
			
			[155, 55, -155],
			[155, 55, -50],
			[155, 55, 55]
			
		];
		leftRight.leftRightInit();
		// */
		
	
		function getDepth(angle){
			var angle = Math.abs((180/Math.PI)*angle) % 360;
			
			if( angle < 45){ // angle > -45 &&
				return 0;
			}else if(angle > 45 && angle < 135){
				return 1;
			}else if(angle > 135 && angle < 225){
				return 3
			}else if(angle > 315 && angle < 360){
				return 2;
			}
		}
		
		var angleY = 0;//Math.PI/4;//Math.PI/4;//Math.PI/4;
		var angleX = 0;Math.PI/4;
		
		var countangleY = 0;
		var countangleX = 0;
		// */
		stage.addEvent('mousemove', function (x, y) {
			angleY = (x - 300) * .0005;
            //angleX = (y - 200) * .0005;
			
			//countangleY += angleY;
		});
		
		stage.ondraw = function(){};
		
		stage.draw = function(){
			//var t = new Date().getTime();
			this.clear();

			for(var i=0; i<this.childList.length; i++){ //旋转
				this.childList[i].rotateY(angleY);
				this.childList[i].rotateX(angleX);
			}
			
			this.childList.sort(function (a, b) {//排序
				return b.depth - a.depth
			});
			
			var ctx = this.ctx;//重画
			for(var i=0; i<this.childList.length; i++){
				this.childList[i].draw(ctx);
			}
			//console.log(new Date().getTime() -t );
		};
		

		
		stage.start();
		setTimeout(function(){
			//stage.stop();
		}, 0)
       // g.stroke();  
	</script>
</body>
</html>