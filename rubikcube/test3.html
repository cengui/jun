<!DOCTYPE html>
<html>
<style>
html {overflow:hidden}
body {position: absolute; margin:0; padding:0;width:100%; height:100%}
canvas {display:block;border:2px solid #ccc; margin:10px auto;}
p {text-align: center; font-size:12px;color:#454545;}
</style>
<script src="js/JCanvas.0.1.js"></script>
<body>
	<canvas id="canvas" width="600" height="400"></canvas>
</body>
	<script>
	
		var canvas = document.getElementById("canvas");
		var stage = new CVS.$stage(canvas);
		var vpx = canvas.width / 2;
		var vpy = canvas.height / 2;
		
		
		function Rect(stage, x, y, z){
			var width = 100;
			this.stage = stage;
			this.ctx = stage.ctx;
			this.width = width;
			this.cube = [
				//前后 z轴不边
				//-155, -155, -155
				[x, y ,z],
				[x+width, y ,z],
				[x+width, y+width ,z],
				
				[x, y+width ,z]
			];
			/**
			this.cube = [
				//右上
				//-155, -155, -155
				[-155, -155, -155],
				[-55, -155 ,-155],
				[-55, -55 ,-155],
				//右下
				[-155, -155, -155],
				[-55, -55 ,-155],
				[-155, -55 ,-155]
			];
			*/
			this.x = 0;
			this.y = 0;
			this.width = 0;
			this.height = 0;
			
			this.balls = [];
			this.triangle = [];
			this.init();
		};
		Rect.prototype = {
			init:function(){
				var cube = this.cube;
				//var ball = null;
				balls = this.balls;
				//CVS.createTriangle;
				for(var i=0; i<cube.length; i++){
					var ball = CVS.createPoint3D(this.ctx, function(){
						this.xpos = cube[i][0];
						this.ypos = cube[i][1];
						this.zpos = cube[i][2];
						this.width = 0;
						this.draw = function(){};
					});
					ball.setVanishPoint(vpx, vpy);
					ball.setCenterPoint(0, 0, 600);
					//stage.addChild(ball);
					balls.push(ball);
				}
				this.triangle.push( CVS.createTriangle(this.ctx, balls[0], balls[1], balls[2], 0x6666cc, false) );
				this.triangle.push( CVS.createTriangle(this.ctx, balls[0], balls[2], balls[3], 0x6666cc, false) );
				stage.addChild(this);
			},
			draw:function(){
				this.setRotateXY(0.01 , 0);
				this.triangle[0].draw();
				this.triangle[1].draw();
				/**
				this.x = balls[0].screenX;
				this.y = balls[0].screenY;
				this.width = balls[3].screenX - balls[0].screenX;
				this.height = balls[3].screenY - balls[0].screenY;*/
			},
			render:function(){
				this.draw();
			},
			setRotateXY:function(angleX, angleY){
				for(var i=0; i<this.balls.length; i++){
					this.balls[i].rotateX(angleX);
					this.balls[i].rotateY(angleY);
				}
			},
			setRotateX:function(angleX){
				for(var i=0; i<this.balls.length; i++){
					this.balls[i].rotateX(angleX);
				}
			},
			setRotateY:function(angleY){
				for(var i=0; i<this.balls.length; i++){
					this.balls[i].rotateY(angleY);
				}
			}
			
		};
		
		
		function Rects(stage){
			//前后
			this.stage = stage;
			this.before = [
				[-155, -155, -155],
				[-155, -50, -155],
				[-155, 55, -155],
				
				[-50, -155, -155],
				[-50, -50, -155],
				[-50, 55, -155],
				
				[55, -155, -155],
				[55, -50, -155],
				[55, 55, -155]
			];
			this.after = [];
			this.rects = [];
			this.init();
		}
		
		Rects.prototype = {
			init:function(){
				var after = this.after;
				var before = this.before;
				var rects = this.rects;
				for(var i=0; i<before.length; i++){
					after.push([before[i][0], before[i][1], -before[i][2]]);
					rects.push(new Rect(this.stage, before[i][0], before[i][1], before[i][2]));
					rects.push(new Rect(this.stage, before[i][0], before[i][1], -before[i][2]));
				}
			}
		};
		//var a = new Rect(stage.ctx, -155, 155, -155);
		//a.draw();
		
		//前面
		//var rect = new Rect(stage, -155, -155, -155);
		//stage.addChild(rect);
		var rects = new Rects(stage);
		
		
		
		stage.start();
	</script>
</html>
