<!DOCTYPE HTML>
<html lang="en-US">
<head>
	<meta charset="UTF-8">
	<title>Test 5</title>
	<style type="text/css">
		html {overflow:hidden}
		body {position: absolute; margin:0; padding:0;width:100%; height:100%}
		canvas {display:block;border:2px solid #ccc; margin:10px auto;}
		p {text-align: center; font-size:12px;color:#454545;}
	</style>
	<script type="text/javascript" src="js/JCanvas.0.1_2.js"></script>
	<script type="text/javascript" src="js/plugin_jc.js"></script>
</head>
<body>
	<canvas id="canvas" width="600" height="400"></canvas>
	
	<script type="text/javascript">
		var canvas = document.getElementById('canvas');
		var stage = new CVS.$stage(canvas);
		var balls = [];
		
		function Rects(stage, rect){
			//前后
			this.stage = stage;
			this.data = null;
			this.after = [];
			this.rects = [];
			this.rect = rect;
			//this.init();
		}

		Rects.prototype = {
			init:function(){},
			setRectData:function(data){
				this.data = data;
			},
			frontBackInit:function(){
				var after = this.after;
				var data = this.data;
				var rects = this.rects;
				for(var i=0; i<data.length; i++){
					after.push([data[i][0], data[i][1], -data[i][2]]);
					rects.push(new this.rect(this.stage, data[i][0], data[i][1], data[i][2], "#f30"));
					rects.push(new this.rect(this.stage, data[i][0], data[i][1], -data[i][2], "#ccc"));
				}
			},
			upDownInit:function(){
				var after = this.after;
				var data = this.data;
				var rects = this.rects;
				for(var i=0; i<data.length; i++){
					after.push([data[i][0], data[i][1], -data[i][2]]);
					rects.push(new this.rect(this.stage, data[i][0], data[i][1], data[i][2], "#ff9900"));
					rects.push(new this.rect(this.stage, data[i][0], -data[i][1], data[i][2], "#3c00ff"));
				}
			},
			leftRightInit:function(){
				var after = this.after;
				var data = this.data;
				var rects = this.rects;
				for(var i=0; i<data.length; i++){
					after.push([data[i][0], data[i][1], -data[i][2]]);
					rects.push(new this.rect(this.stage, data[i][0], data[i][1], data[i][2], "#3ab504"));
					rects.push(new this.rect(this.stage, -data[i][0], data[i][1], data[i][2], "#fff60e"));
				}
			}
		};
		
		//*
		//上下
		var updown = new Rects(stage, UpDownRect);
		updown.data = [
			[-155, -155, 155],
			[-50, -155, 155],
			[55, -155, 155],
			
			[-155, -155, 50],
			[-50, -155, 50],
			[55, -155, 50],
			
			[-155, -155, -55],
			[-50, -155, -55],
			[55, -155, -55],
			
		];
		updown.upDownInit();
		
		
			// 前后
		var befor = new Rects(stage, FrontBackRect);
		befor.data = [
			[-155, -155, -155],
			[-155, -50, -155],
			[-155, 55, -155],
			
			[-50, -155, -155],
			[-50, -50, -155],
			[-50, 55, -155],
			
			[55, -155, -155],
			[55, -50, -155],
			[55, 55, -155]
		];
		befor.frontBackInit();
		
		//*
		//左右
		var leftRight = new Rects(stage, LeftRightRect);
		leftRight.data = [
			[155, -155, -155],
			[155, -155, -50],
			[155, -155, 55],
			
			[155, -50, -155],
			[155, -50, -50],
			[155, -50, 55],
			
			[155, 55, -155],
			[155, 55, -50],
			[155, 55, 55]
			
		];
		leftRight.leftRightInit();
		// */
		
	
		
		
		
		// */
		
		stage.onRefresh = function(){
			//var balls = this.chindList;
			console.log(balls.length);
			for (var i=0,ball; ball=balls[i]; i++) { 
			  ball.rotateX(0.01);
			  // ball.rotateY(angleY);

			  // ball.x = ball.screenX;
			   //ball.y = ball.screenY;
            }

			var triangles = this.children;
			//console.log(this);
            triangles.sort(function (a, b) { return b.depth - a.depth });
			for (var j = 0; j < triangles.length; j ++) {
				triangles[j].draw();
			}
		};
		stage.ondraw = function(){
			//this.childList.sort(function (a, b) { return  b.depth - a.depth });
			/**
			for(var i=0; i<this.childList.length; i++){
				console.log( this.childList[i].pointA.zpos, this.childList[i].pointB.zpos, this.childList[i].pointC.zpos );
				console.log( Math.min(this.childList[i].pointA.zpos, this.childList[i].pointB.zpos, this.childList[i].pointC.zpos) );
			}*/
		};
		
		stage.start();
		setTimeout(function(){
		//stage.stop();
		}, 30)
       // g.stroke();  
	</script>
</body>
</html>